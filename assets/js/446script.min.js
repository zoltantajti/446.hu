$(document).ready(e=>{window.location.href.includes("profile")&&(initRadios(),initAntennas(),initFreqs())});let mylat,mylon,remlat,remlon=0;const getGeoCode=e=>(e=encodeURIComponent(e),new Promise((a,t)=>{$.getJSON(`https://geocode.maps.co/search?q=${e}&api_key=663371914590f062701345usb7a1683`,e=>{a({lat:e[0].lat,lon:e[0].lon})}).fail(e=>{t(e)})})),getQTHCode=e=>{let a=e.lat;var t=(1*e.lon+180)/20,n=(1*a+90)/10,r=String.fromCharCode(Math.floor(t)+65)+String.fromCharCode(Math.floor(n)+65);return n=n%1*10,r=r+String.fromCharCode(Math.floor(t=t%1*10)+48)+String.fromCharCode(Math.floor(n)+48),n=n%1*24,(r=r+String.fromCharCode(Math.floor(t=t%1*24)+97)+String.fromCharCode(Math.floor(n)+97)).toUpperCase()},calculateQTH=e=>{let a=$(`#${e}_country`).val()+", "+$(`#${e}_county`).val()+", "+$(`#${e}_city`).val()+" "+$(`#${e}_address`).val();getGeoCode(a).then(a=>{"my"===e&&(mylat=a.lat,mylon=a.lon,$("#myPos").val(JSON.stringify(a))),"rem"===e&&(remlat=a.lat,remlon=a.lon,$("#remPos").val(JSON.stringify(a))),getQTHCode(a),$(`#${e}_qth`).val(getQTHCode(a))})};function FNCoordinates(e){var a=String(e);let t=20*((a=a.toUpperCase()).charCodeAt(0)-65),n=10*(a.charCodeAt(1)-65);return t+=2*(a.charCodeAt(2)-48),n+=a.charCodeAt(3)-48,t+=(a.charCodeAt(4)-65+.5)/12,n+=(a.charCodeAt(5)-65+.5)/24,t-=180,{lat:(n-=90).toFixed(8),lon:t.toFixed(8)}}function degreesToRadians(e){return e*(Math.PI/180)}function calculateDistance(e,a){let t=degreesToRadians(e.lat),n=degreesToRadians(a.lat),r=degreesToRadians(a.lat-e.lat),l=degreesToRadians(a.lon-e.lon),i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(t)*Math.cos(n)*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))}$("#calculateDistance").on("click",e=>{let a=!1;if(0===$("#my_qth").val().length&&(alert("Elősz\xf6r gener\xe1ld le a QTH lok\xe1tor k\xf3dod!"),$("#my_country").focus(),a=!0),0!==$("#rem_qth").val().length||a||(alert("Elősz\xf6r gener\xe1ld le az Ellen\xe1llom\xe1s QTH lok\xe1tor k\xf3dj\xe1t!"),$("#rem_country").focus(),a=!0),!a){let t=FNCoordinates($("#my_qth").val()),n=FNCoordinates($("#rem_qth").val()),r=calculateDistance(t,n);$("#distance").val(`${r.toFixed(2)} Km`)}}),$("#mode").change(e=>{"/D"===$("#mode").val()?($("#parrotFrame").addClass("hidden"),$("#amateurFrame").addClass("hidden")):"/P"===$("#mode").val()?($("#parrotFrame").removeClass("hidden"),$("#amateurFrame").addClass("hidden")):"/A"===$("#mode").val()&&($("#parrotFrame").addClass("hidden"),$("#amateurFrame").removeClass("hidden"))}),$("#profile-countries").change(e=>{"Magyarorsz\xe1g"===$("#profile-countries").val()?($("#profile-counties").attr("list","counties"),$("#profile-cities").attr("list",null)):(alert("OK"),$("#profile-counties").attr("list",null),$("#profile-cities").attr("list",null))}),$("#profile-counties").change(e=>{let a=$("#profile-counties").val();$.getJSON("Rest/getCitiesByCounty/"+a,e=>{$("#cities").empty(),e.forEach((e,a)=>{let t=`<option value="${e.name}">`;$("#cities").append(t)})})});let radios=[],antennas=[],freqs=[];const initRadios=()=>{JSON.parse($("#radios").val()).forEach(e=>{createRadioItem(e)})},initAntennas=()=>{JSON.parse($("#antennas").val()).forEach(e=>{createAntennaItem(e)})},initFreqs=()=>{JSON.parse($("#freqs").val()).forEach(e=>{createFreqItem(e)})},createRadioItem=(e,a=!1)=>{let t=e.replace("/s+/g","-"),n=document.createElement("a");n.href="javascript:;",n.innerHTML='<i class="fa fa-fw fa-times red"></i>',n.addEventListener("click",()=>{let a=document.getElementById("RI_"+t);if(a){let n=radios.indexOf(e);-1!==n&&radios.splice(n,1),a.remove(),updateRadioField()}});let r=document.createElement("span");r.classList.add("radioItem"),r.classList.add("input-group-text"),r.id="RI_"+t,r.textContent=e,r.appendChild(n),$("#radiosFrameAfter").after(r),radios.push(e),updateRadioField()},createAntennaItem=(e,a=!1)=>{let t=e.replace("/s+/g","-"),n=document.createElement("a");n.href="javascript:;",n.innerHTML='<i class="fa fa-fw fa-times red"></i>',n.addEventListener("click",()=>{let a=document.getElementById("AI_"+t);if(a){let n=antennas.indexOf(e);-1!==n&&antennas.splice(n,1),a.remove(),updateAntennaField()}});let r=document.createElement("span");r.classList.add("radioItem"),r.classList.add("input-group-text"),r.id="AI_"+t,r.textContent=e,r.appendChild(n),$("#antennasFrameAfter").after(r),antennas.push(e),updateAntennaField()},createFreqItem=(e,a=!1)=>{let t=e.replace("/s+/g","-"),n=document.createElement("a");n.href="javascript:;",n.innerHTML='<i class="fa fa-fw fa-times red"></i>',n.addEventListener("click",()=>{let a=document.getElementById("FI_"+t);if(a){let n=freqs.indexOf(e);-1!==n&&freqs.splice(n,1),a.remove(),updateFreqField()}});let r=document.createElement("span");r.classList.add("radioItem"),r.classList.add("input-group-text"),r.id="FI_"+t,r.textContent=e,r.appendChild(n),$("#freqsFrameAfter").after(r),freqs.push(e),updateFreqField()},updateRadioField=()=>{$("#radios").val(JSON.stringify(radios))},updateAntennaField=()=>{$("#antennas").val(JSON.stringify(antennas))},updateFreqField=()=>{$("#freqs").val(JSON.stringify(freqs))};$("#addRadio").on("click",e=>{0==$("#radios_input").val().length?alert("A r\xe1di\xf3 mező nem lehet \xfcres!"):(createRadioItem($("#radios_input").val()),$("#radios_input").val(""))}),$("#addAntenna").on("click",e=>{0==$("#antennas_input").val().length?alert("Az antenna mező nem lehet \xfcres!"):(createAntennaItem($("#antennas_input").val()),$("#antennas_input").val(""))}),$("#addFreq").on("click",e=>{0==$("#freqs_input").val().length?alert("Az antenna mező nem lehet \xfcres!"):(createFreqItem($("#freqs_input").val()),$("#freqs_input").val(""))});